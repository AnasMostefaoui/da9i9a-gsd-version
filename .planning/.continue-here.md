---
phase: pre-phase (deployment setup)
task: deployment
total_tasks: 1
status: waiting_for_confirmation
last_updated: 2026-01-27T23:15:00+03:00
---

<current_state>
Railway deployment fixed and building successfully. Waiting for deploy logs to confirm app is running. This was pre-phase work to eliminate ngrok dependency before starting Phase 1.
</current_state>

<completed_work>

- Railway deployment configuration fixed
  - Moved `prisma migrate deploy` from build phase to start command (DATABASE_URL only available at runtime)
  - Downgraded Prisma 7 → Prisma 6 (Prisma 7 requires Node 20.19+/22.12+, Railway provides 20.18.1)
  - Fixed ESM compatibility issue with `@prisma/dev` and `zeptomatch` (GitHub Issue #28784)
  - Removed `@prisma/adapter-pg` (not needed in Prisma 6)
  - Updated schema to use standard `prisma-client-js` generator
  - Simplified `db.server.ts` to standard PrismaClient import
  - Updated `.npmrc` to allow Prisma build scripts
- Build passing on Railway (see logs: pnpm install 4.8s, build 312ms)
</completed_work>

<remaining_work>

- Confirm Railway deploy logs show app running
- Generate Railway domain in Settings → Networking
- Update Salla app callback URL to `https://[your-app].railway.app/auth/salla/callback`
- Set Railway environment variables: SALLA_CLIENT_ID, SALLA_CLIENT_SECRET, SALLA_REDIRECT_URI, SESSION_SECRET
- Then: `/gsd:plan-phase 1` to start Foundation phase
</remaining_work>

<decisions_made>

- Downgraded to Prisma 6 because Prisma 7 has ESM bugs with `@prisma/dev` that won't be fixed until Railway updates Node versions
- Kept Railway (not switching platforms) because PostgreSQL is included and it's simple
- No separate auth system needed - Salla OAuth handles merchant authentication (key decision from project planning)
- Inngest for background jobs (already decided in PROJECT.md, not changed)
</decisions_made>

<blockers>
None - deployment is proceeding
</blockers>

<context>
User was frustrated with ngrok URL swapping during development. Prioritized getting a stable Railway deployment before starting Phase 1 work. The app already has:
- React Router 7 framework
- Prisma schema with Merchant and Product models
- OAuth routes stubbed out
- Basic dashboard and import pages
- Landing page widget system

Phase 1 (Foundation) will formalize: OAuth flow, token refresh mutex, webhook handling, job queue setup.
</context>

<next_action>
1. Check Railway deploy logs for successful startup
2. Generate domain and update Salla callback URL
3. Set environment variables in Railway dashboard
4. Test OAuth flow works end-to-end
5. Then run `/gsd:plan-phase 1`
</next_action>
